---
import '../styles/global.css';
import '../styles/shutdown.css';
import '../styles/crt-effects.css';
import { ClientRouter } from 'astro:transitions';

interface Props {
	title: string;
	description?: string;
}

const { title, description = "AI-driven development experiments in VRChat â€” 20,000+ lines built with Claude Code, from zero to a fully-featured interactive world." } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" data-theme="synthwave">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/jpeg" href="/favicon.jpg" />
		<meta name="generator" content={Astro.generator} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:type" content="website" />
		<meta property="og:url" content="https://basementos.com" />
		<meta property="og:image" content="https://basementos.com/favicon.jpg" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content={title} />
		<meta name="twitter:description" content={description} />
		<title>{title}</title>
        <ClientRouter />
        <script is:inline>
            // Disable browser's scroll restoration to prevent progress bar on scroll
            // Astro's ClientRouter calls history.replaceState during scroll which
            // triggers native mobile browser progress indicators
            if ('scrollRestoration' in history) {
                history.scrollRestoration = 'manual';
            }
        </script>
        <script is:inline>
            // Immediately invoked function to set the theme before FOUC
            (function() {
                try {
                    const savedTheme = localStorage.getItem('basement-os-theme') || 'synthwave';
                    document.documentElement.setAttribute('data-theme', savedTheme);
                } catch (e) {
                    console.error('Theme detection failed', e);
                }
            })();
        </script>
	</head>
    <script>
        import { initModeState } from '../scripts/modeStore';
        
        // Run on initial load
        initModeState();
        
        // Run after every view transition to restore persistent state
        document.addEventListener('astro:after-swap', initModeState);
    </script>
	<body>
		<slot />
	</body>
</html>
